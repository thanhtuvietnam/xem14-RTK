var _=r=>{throw TypeError(r)};var R=(r,d,t)=>d.has(r)||_("Cannot "+t);var s=(r,d,t)=>(R(r,d,"read from private field"),t?t.call(r):d.get(r)),y=(r,d,t)=>d.has(r)?_("Cannot add the same private member more than once"):d instanceof WeakSet?d.add(r):d.set(r,t),n=(r,d,t,e)=>(R(r,d,"write to private field"),e?e.call(r,t):d.set(r,t),t),o=(r,d,t)=>(R(r,d,"access private method"),t);import{m as z,n as A,p as G,e as H,b as J,q as K,t as Q,u as S,o as C,v as W}from"./index-xleVCo4H.js";import{E as X}from"./vidstack-CJK75N1i-CQEs4XXL.js";import{resolveYouTubeVideoId as Z}from"./vidstack-Zc3I7oOd-CA6XwpqT.js";const g={Unstarted:-1,Ended:0,Playing:1,Paused:2,Buffering:3,Cued:5};var a,v,k,w,P,f,p,i,B,D,O,b,U,Y,F,M,E,x,L,I,$,q;class at extends X{constructor(t,e){super(t);y(this,i);y(this,a);y(this,v);y(this,k);y(this,w);y(this,P);y(this,f);y(this,p);this.$$PROVIDER_TYPE="YOUTUBE",this.scope=z(),n(this,v,A("")),n(this,k,-1),n(this,w,null),n(this,P,-1),n(this,f,!1),n(this,p,new Map),this.language="en",this.color="red",this.cookies=!1,n(this,a,e)}get currentSrc(){return s(this,w)}get type(){return"youtube"}get videoId(){return s(this,v).call(this)}preconnect(){G(this.getOrigin())}setup(){super.setup(),H(o(this,i,O).bind(this)),s(this,a).notify("provider-setup",this)}destroy(){o(this,i,I).call(this);const t="provider destroyed";for(const e of s(this,p).values())for(const{reject:h}of e)h(t);s(this,p).clear()}async play(){return o(this,i,b).call(this,"playVideo")}async pause(){return o(this,i,b).call(this,"pauseVideo")}setMuted(t){t?o(this,i,b).call(this,"mute"):o(this,i,b).call(this,"unMute")}setCurrentTime(t){o(this,i,b).call(this,"seekTo",t),s(this,a).notify("seeking",t)}setVolume(t){o(this,i,b).call(this,"setVolume",t*100)}setPlaybackRate(t){o(this,i,b).call(this,"setPlaybackRate",t)}async loadSource(t){if(!J(t.src)){n(this,w,null),s(this,v).set("");return}const e=Z(t.src);s(this,v).set(e??""),n(this,w,t)}getOrigin(){return this.cookies?"https://www.youtube.com":"https://www.youtube-nocookie.com"}buildParams(){const{keyDisabled:t}=s(this,a).$props,{muted:e,playsInline:h,nativeControls:l}=s(this,a).$state,u=l();return{autoplay:0,cc_lang_pref:this.language,cc_load_policy:u?1:void 0,color:this.color,controls:u?1:0,disablekb:!u||t()?1:0,enablejsapi:1,fs:1,hl:this.language,iv_load_policy:u?1:3,mute:e()?1:0,playsinline:h()?1:0}}onLoad(){window.setTimeout(()=>this.postMessage({event:"listening"}),100)}onMessage({info:t},e){var c;if(!t)return;const{title:h,intrinsicDuration:l,playbackRate:u}=s(this,a).$state;if(Q(t.videoData)&&t.videoData.title!==h()&&s(this,a).notify("title-change",t.videoData.title,e),S(t.duration)&&t.duration!==l()){if(S(t.videoLoadedFraction)){const m=((c=t.progressState)==null?void 0:c.loaded)??t.videoLoadedFraction*t.duration,T=new C(0,t.duration);o(this,i,M).call(this,m,T,e)}s(this,a).notify("duration-change",t.duration,e)}if(S(t.playbackRate)&&t.playbackRate!==u()&&s(this,a).notify("rate-change",t.playbackRate,e),t.progressState){const{current:m,seekableStart:T,seekableEnd:V,loaded:N,duration:j}=t.progressState;o(this,i,F).call(this,m,e),o(this,i,M).call(this,N,new C(T,V),e),j!==l()&&s(this,a).notify("duration-change",j,e)}if(S(t.volume)&&W(t.muted)&&!s(this,f)){const m={muted:t.muted,volume:t.volume/100};s(this,a).notify("volume-change",m,e)}S(t.playerState)&&t.playerState!==s(this,k)&&o(this,i,L).call(this,t.playerState,e)}}a=new WeakMap,v=new WeakMap,k=new WeakMap,w=new WeakMap,P=new WeakMap,f=new WeakMap,p=new WeakMap,i=new WeakSet,B=function(t){var e;(e=o(this,i,$).call(this,"playVideo"))==null||e.reject(t)},D=function(t){var e;(e=o(this,i,$).call(this,"pauseVideo"))==null||e.reject(t)},O=function(){o(this,i,I).call(this);const t=s(this,v).call(this);if(!t){this.src.set("");return}this.src.set(`${this.getOrigin()}/embed/${t}`),s(this,a).notify("load-start")},b=function(t,e){let h=K(),l=s(this,p).get(t);return l||s(this,p).set(t,l=[]),l.push(h),this.postMessage({event:"command",func:t,args:e?[e]:void 0}),h.promise},U=function(t){s(this,a).notify("loaded-metadata"),s(this,a).notify("loaded-data"),s(this,a).delegate.ready(void 0,t)},Y=function(t){var e;(e=o(this,i,$).call(this,"pauseVideo"))==null||e.resolve(),s(this,a).notify("pause",void 0,t)},F=function(t,e){const{duration:h,realCurrentTime:l}=s(this,a).$state,u=s(this,k)===g.Ended,c=u?h():t;s(this,a).notify("time-change",c,e),!u&&Math.abs(c-l())>1&&s(this,a).notify("seeking",c,e)},M=function(t,e,h){const l={buffered:new C(0,t),seekable:e};s(this,a).notify("progress",l,h);const{seeking:u,realCurrentTime:c}=s(this,a).$state;u()&&t>c()&&o(this,i,E).call(this,h)},E=function(t){const{paused:e,realCurrentTime:h}=s(this,a).$state;window.clearTimeout(s(this,P)),n(this,P,window.setTimeout(()=>{s(this,a).notify("seeked",h(),t),n(this,P,-1)},e()?100:0))},x=function(t){const{seeking:e}=s(this,a).$state;e()&&o(this,i,E).call(this,t),s(this,a).notify("pause",void 0,t),s(this,a).notify("end",void 0,t)},L=function(t,e){var V;const{paused:h,seeking:l}=s(this,a).$state,u=t===g.Playing,c=t===g.Buffering,m=o(this,i,q).call(this,"playVideo"),T=(h()||m)&&(c||u);if(c&&s(this,a).notify("waiting",void 0,e),l()&&u&&o(this,i,E).call(this,e),s(this,f)&&u){this.pause(),n(this,f,!1),this.setMuted(s(this,a).$state.muted());return}if(!m&&T){n(this,f,!0),this.setMuted(!0);return}switch(T&&((V=o(this,i,$).call(this,"playVideo"))==null||V.resolve(),s(this,a).notify("play",void 0,e)),t){case g.Unstarted:o(this,i,B).call(this,"provider rejected"),o(this,i,D).call(this,"provider rejected"),s(this,a).notify("pause",void 0,e);break;case g.Cued:o(this,i,U).call(this,e);break;case g.Playing:s(this,a).notify("playing",void 0,e);break;case g.Paused:o(this,i,Y).call(this,e);break;case g.Ended:o(this,i,x).call(this,e);break}n(this,k,t)},I=function(){n(this,k,-1),n(this,P,-1),n(this,f,!1)},$=function(t){var e;return(e=s(this,p).get(t))==null?void 0:e.shift()},q=function(t){var e;return!!((e=s(this,p).get(t))!=null&&e.length)};export{at as YouTubeProvider};
